(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2cf836f4"],{"04e6":function(t,e,a){(t.exports=a("690e")(!1)).push([t.i,".demo-ruleForm{margin:15px 0;width:80%;padding-bottom:50px}.demo-ruleForm .post-rate .el-rate{margin-top:10px}.demo-ruleForm .dr-submitContent{position:fixed;z-index:9999999;padding:10px 30px;text-align:right;right:0;bottom:0;background:none;margin-bottom:0}.demo-ruleForm .avatar-uploader .el-upload{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.demo-ruleForm .avatar-uploader .el-upload:hover{border-color:#409eff}.demo-ruleForm .avatar-uploader-icon{font-size:28px;color:#8c939d;width:200px;height:150px;line-height:150px;text-align:center}.demo-ruleForm .avatar{width:200px;height:158px;display:block}.demo-ruleForm .upSimg{position:relative}.demo-ruleForm .upSimg .refresh-btn{position:absolute;left:220px;top:0}.demo-ruleForm .upSimg .refresh-btn i{font-weight:400}.demo-ruleForm .el-range-editor.el-input__inner{width:100%}.demo-ruleForm .el-select-suffix{width:0;overflow:visible}.demo-ruleForm .el-select-suffix .el-input__suffix-inner{position:absolute;right:100%;white-space:nowrap;background-color:#fff;background-clip:content-box;border:2px solid transparent;max-height:-webkit-fill-available}",""])},1179:function(t,e,a){"use strict";a("53f5")},1953:function(t,e,a){"use strict";a.r(e);a("ac67"),a("32ea"),a("1bc7"),a("0c84"),a("c5cb");var r=a("0e2e"),o=(a("e5b4"),a("34f5")),n=(a("6e69"),a("330f")),i=(a("ac50"),a("873e"),a("5c10"),a("0bbd"),a("9736"),a("79b1")),s=a("196d"),l={groups:Array},m={nameMod:nameMod,contentState:[{value:"0",label:"撤回",color:""},{value:"1",label:"草稿",color:"#409EFF"},{value:"2",label:"发布",color:"#67C23A"}]},c={VueUeditorWrap:a.n(s).a,ListURL:function(){return a.e("chunk-0b4b1713").then(a.bind(null,"33b5"))},LinkWX:function(){return a.e("chunk-2d887e12").then(a.bind(null,"1f3f"))},Cropper:function(){return Promise.all([a.e("chunk-7cebce3a"),a.e("chunk-672af0a4")]).then(a.bind(null,"66ff"))},SelectIds:function(){return a.e("chunk-243af39c").then(a.bind(null,"6d92"))}};var f={updateKeywords:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=this.formState.formData.keywords.split(","),o=[];return t&&""!=t&&t instanceof String&&(o=[t]),t&&0<t.length&&t instanceof Array&&(o=(o=t.filter(function(t){return t&&t.name||t instanceof String})).map(function(t){return t.name||t})),e?a=a.filter(function(t){return-1===o.indexOf(t)}):a.push.apply(a,Object(r.a)(o)),a=Object(r.a)(new Set(a)),this.formState.formData.keywords=a.join(),this.formState.formData.keywords},getLocalContents:function(){var t=localStorage.getItem("addContent")||"";return t?JSON.parse(t):{}},editorReady:function(t){this.ueditorObj=t},backToList:function(){this.$router.push(this.$root.adminBasePath+"/"+this.nameMod)},submitForm:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a=this;""!=e&&(a.formState.formData.state=e),this.$refs[t].validate(function(t){if(!t)return!1;t=Object.assign({},a.formState.formData,{comments:a.ueditorObj.getContent(),simpleComments:a.ueditorObj.getPlainTxt()});a.formState.edit?Object(i.f)(t,a.nameMod).then(function(t){200===t.status?(localStorage.removeItem(a.$route.path.split("/")[1]),a.backToList(),a.$message({message:a.$t("main.updateSuccess"),type:"success"})):a.$message.error(t.message)}).catch(function(t){debugger;a.$message.error(JSON.stringify(t))}):Object(i.a)(t,a.nameMod).then(function(t){200===t.status?(localStorage.removeItem(a.$route.path.split("/")[1]),a.backToList(),a.$message({message:a.$t("main.addSuccess"),type:"success"})):a.$message.error(t.message)}).catch(function(t){a.$message.error(t.message)})})}},d=a("60bb"),u=a.n(d),s=a("5880");function p(e,t){var a,o=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,a)),o}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach(function(t){Object(o.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}d=Object(s.createNamespacedHelpers)(nameMod),s={props:g({},l),data:function(){var o=this;return g(g({},m),{},{editorConfig:{autoHeightEnabled:!1,initialFrameHeight:240,initialFrameWidth:"100%",serverUrl:"/api/upload/ueditor",UEDITOR_HOME_URL:this.$root.staticRootPath+"/plugins/ueditor/"},rules:{sImg:[{required:!0,message:this.$t("validate.selectNull",{label:"缩略图"}),trigger:"blur"}],name:[{required:!0,message:this.$t("validate.inputNull",{label:this.$t("contents.name")}),trigger:"blur"},{min:1,max:50,message:this.$t("validate.rangelength",{min:1,max:50}),trigger:"blur"}],tags:[{validator:function(t,e,a){u.a.isEmpty(e)?a(new Error(o.$t("validate.selectNull",{label:o.$t("contents.tags")}))):a()},trigger:"change"}],discription:[{required:!0,message:this.$t("validate.inputNull",{label:this.$t("contents.discription")}),trigger:"blur"},{min:5,max:300,message:this.$t("validate.rangelength",{min:5,max:100}),trigger:"blur"}],comments:[{required:!0,message:this.$t("validate.inputNull",{label:this.$t("contents.comments")}),trigger:"blur"},{min:5,message:this.$t("validate.rangelength",{min:5,max:1e5}),trigger:"blur"}]}})},components:g({},c),methods:g(g(g({},f),d.mapActions(["showContentForm"])),{},{eChangeFormats:function(t){var e=this;e.formState.formData.listFormatTags=t.listIds,"delete"==t.strAction?e.formState.formData.tags=e.formState.formData.tags.filter(function(e){return!t.listObjDiff.find(function(t){return t._id==e})}):e.formState.formData.tags=Object(r.a)(new Set(e.formState.formData.tags.concat(t.listIds))),e.updateKeywords(t.listObjDiff,"delete"==t.strAction)},createFormatTag:function(t){return{name:t,comments:"发行介质",alias:t}},eChangeArtist:function(t){this.formState.formData.listRefs=t.listIds,this.updateKeywords(t.listObjDiff,"delete"==t.strAction)},eChangeTag:function(t){this.formState.formData.tags=t.listIds,this.updateKeywords(t.listObjDiff,"delete"==t.strAction)}}),computed:g(g({},Object(s.mapGetters)(["contentCategoryList"])),d.mapState({formState:function(t){return t.formState}})),mounted:function(){var o,e;Object(n.a)(this),(o=this).$route.params.id?Object(i.b)({id:o.$route.params.id},o.nameMod).then(function(t){var e,a;200===t.status?t.data?(e=t.data,a=[],e.categories&&(e.categories.map(function(t,e){t&&a.push(t._id)}),e.categories=a),e.tags&&(e.tags=e.tags.map(function(t){return t&&t._id})),e.keywords&&(e.keywords=e.keywords.join()),e.listRefs&&(e.listRefs=e.listRefs.map(function(t){return t._id})),e.listMembers&&(e.listMembers=e.listMembers.map(function(t){return t._id})),e.listFormatTags&&(e.listFormatTags=e.listFormatTags.map(function(t){return t&&t._id})),o.showContentForm({edit:!0,formData:e})):o.$message({message:o.$t("validate.error_params"),type:"warning",onClose:function(){o.backToList()}}):o.$message.error(t.message)}).catch(function(t){debugger}):(e=o.getLocalContents(),_.isEmpty(e)?o.showContentForm({edit:!1}):o.$confirm(o.$t("main.askForReInputContent"),o.$t("main.scr_modal_title"),{confirmButtonText:o.$t("main.confirmBtnText"),cancelButtonText:o.$t("main.cancelBtnText"),type:"warning"}).then(function(){var t=e.comments||"";o.$refs.ueditor.setContent(t),localStorage.removeItem(o.$route.path.split("/")[1]),o.showContentForm({edit:!1,formData:e})}).catch(function(){localStorage.removeItem(o.$route.path.split("/")[1]),o.$message({type:"info",message:o.$t("main.scr_modal_del_error_info")})})),o.$store.dispatch("contentCategory/getContentCategoryList")}},a("1179"),d=a("5d22"),s=Object(d.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dr-contentForm",class:e.classObj},[a("div",{staticClass:"main-container"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.formState.formData,rules:e.rules,"label-width":"120px","label-position":"mobile"==e.device?"top":"right"}},[a("el-form-item",{attrs:{label:e.$t("contents.enable"),prop:"state"}},[a("el-select",{attrs:{size:"small",placeholder:"审核文章"},model:{value:e.formState.formData.state,callback:function(t){e.$set(e.formState.formData,"state",t)},expression:"formState.formData.state"}},e._l(e.contentState,function(t){return a("el-option",{key:"kw_"+t.value,attrs:{label:t.label,value:t.value}})}),1)],1),"3"==e.formState.formData.state?a("el-form-item",{attrs:{label:"驳回原因",prop:"dismissReason"}},[a("el-input",{attrs:{size:"small"},model:{value:e.formState.formData.dismissReason,callback:function(t){e.$set(e.formState.formData,"dismissReason",t)},expression:"formState.formData.dismissReason"}})],1):e._e(),a("el-form-item",{attrs:{label:e.$t(e.nameMod+".name"),prop:"name"}},[a("el-input",{attrs:{size:"small",maxlength:"50","show-word-limit":""},model:{value:e.formState.formData.name,callback:function(t){e.$set(e.formState.formData,"name",t)},expression:"formState.formData.name"}})],1),a("el-form-item",{attrs:{label:e.$t(e.nameMod+".nameAlias"),prop:"alias"}},[a("el-input",{attrs:{size:"small",maxlength:"50","show-word-limit":""},model:{value:e.formState.formData.alias,callback:function(t){e.$set(e.formState.formData,"alias",t)},expression:"formState.formData.alias"}})],1),a("SelectIds",{attrs:{label:this.$t(e.nameMod+".listArtists"),"allow-create":!1,listIds:e.formState.formData.listRefs,nameMode:e.nameMod,apiAdd:!1,apiFind:"/manage/artist/getList",initTag:!1},on:{change:e.eChangeArtist}}),a("el-form-item",{attrs:{label:e.$t(e.nameMod+".dateRelease"),prop:"dateRelease"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"发行日期"},on:{change:e.eChangeDate},model:{value:e.formState.formData.dateRelease,callback:function(t){e.$set(e.formState.formData,"dateRelease",t)},expression:"formState.formData.dateRelease"}})],1),a("SelectIds",{attrs:{label:this.$t(e.nameMod+".listFormatTags"),listIds:e.formState.formData.listFormatTags,nameMode:e.nameMod,apiFind:"/api/record/listAllFormats",initTag:e.createFormatTag},on:{change:e.eChangeFormats}}),"1"==e.formState.formData.type?a("div",[a("SelectIds",{attrs:{label:this.$t(e.nameMod+".tags"),listIds:e.formState.formData.tags,nameMode:e.nameMod,initTag:e.createTag},on:{change:e.eChangeTag}}),a("el-form-item",{attrs:{label:"乐队关键字",prop:"keywords"}},[a("el-input",{attrs:{size:"small"},model:{value:e.formState.formData.keywords,callback:function(t){e.$set(e.formState.formData,"keywords",t)},expression:"formState.formData.keywords"}})],1)],1):e._e(),a("Cropper",{attrs:{nameMod:e.nameMod,label:e.$t("contents.sImg"),prop:"sImg"},model:{value:e.formState.formData.sImg,callback:function(t){e.$set(e.formState.formData,"sImg",t)},expression:"formState.formData.sImg"}}),a("el-form-item",{attrs:{label:e.$t(e.nameMod+".catalog"),prop:"catalog"}},[a("el-input",{attrs:{size:"small",placeholder:""},model:{value:e.formState.formData.catalog,callback:function(t){e.$set(e.formState.formData,"catalog",t)},expression:"formState.formData.catalog"}})],1),a("el-form-item",{attrs:{label:e.$t("contents.discription"),prop:"discription"}},[a("el-input",{attrs:{size:"small",type:"textarea",maxlength:"300","show-word-limit":"",autosize:{minRows:4,maxRows:10}},model:{value:e.formState.formData.discription,callback:function(t){e.$set(e.formState.formData,"discription",t)},expression:"formState.formData.discription"}})],1),a("el-form-item",{attrs:{label:e.$t("contents.comments"),prop:"comments"}},[a("vue-ueditor-wrap",{staticClass:"editorForm",attrs:{config:e.editorConfig},on:{ready:e.editorReady},model:{value:e.formState.formData.comments,callback:function(t){e.$set(e.formState.formData,"comments",t)},expression:"formState.formData.comments"}})],1),a("el-form-item",{attrs:{label:e.$t(e.nameMod+".listLinks"),prop:"listLinks"}},[a("ListURL",{ref:"listLinks",attrs:{label:"购买链接"},model:{value:e.formState.formData.listLinks,callback:function(t){e.$set(e.formState.formData,"listLinks",t)},expression:"formState.formData.listLinks"}})],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(e._s(e.formState.edit?e.$t("main.form_btnText_update"):e.$t("main.form_btnText_save")))]),a("el-button",{attrs:{size:"medium"},on:{click:e.backToList}},[e._v(e._s(e.$t("main.back")))])],1)],1)],1)])},[],!1,null,null,null),e.default=s.exports},"330f":function(t,e,a){"use strict";a.d(e,"a",function(){return n});var e=a("e04f"),o=a.n(e);function r(t){var e=o.a.get("sidebarStatus");t.sidebarOpened="1"==e,t.sidebar&&(t.sidebar.opened=t.sidebarOpened)}function n(e){var t=e.$root;setTimeout(function(){r(e)},500),t&&t.eventBus&&(t.eventBus.$on("toggleSideBar",function(t){setTimeout(function(){r(e)},500)}),t.eventBus.$on("toggleDevice",function(t){e.device=t}));t=document.body.getBoundingClientRect();e.device=t.width-1<992?"mobile":"desktop"}},"53f5":function(t,e,a){var o=a("04e6");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,a("85cb").default)("42fa9bfc",o,!0,{sourceMap:!1,shadowMode:!1})}}]);