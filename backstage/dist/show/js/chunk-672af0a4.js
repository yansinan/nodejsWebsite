(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-672af0a4"],{"388f":function(t,e,i){(t.exports=i("690e")(!1)).push([t.i,".avatar{position:relative;vertical-align:middle;margin:0;padding:0;text-align:center;text-transform:uppercase;font-weight:400;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;max-height:32px;width:32px;height:100%;font-size:21px;line-height:32px;border-radius:50%}.avatar.img-thumbnail{padding:4px;max-width:none}.avatar>img{width:100%}.avatar-32{max-height:32px;width:32px;height:100%;font-size:21px;line-height:32px}.avatar-64{max-height:64px;width:64px;height:100%;font-size:43px;line-height:64px}.avatar-128{max-height:128px;width:128px;height:100%;font-size:85px;line-height:128px}img{-o-object-fit:contain;object-fit:contain}.imgResult{position:relative;height:auto;width:100%;max-height:100%}.bnUpload{font-size:20px;color:#cacaca;width:200px;height:200px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:36px}",""])},"66ff":function(t,e,i){"use strict";i.r(e);i("61e3");var a,n,r=i("ed32"),o=(i("9736"),i("0bbd"),i("388c"),i("db0e")),s=i.n(o),r=(i("850f"),{name:"ImgCropper",props:{nameMod:{type:String,default:"rubyeyes"},subPath:{type:String,default:""},api:{type:String,default:"/manage/dr/uploadFiles"},prop:{type:String,default:"sImg"},label:{type:String,default:"主图"},value:{type:String,default:""},cropSetting:{type:Object,default:{width:512,height:512,minWidth:256,minHeight:256,maxWidth:1024,maxHeight:1024,fillColor:"#fff",imageSmoothingEnabled:!1,imageSmoothingQuality:"high"}},"before-crop":{type:Function,default:function(t){var e="image/jpeg"===t.type,i="image/png"===t.type,t="image/gif"===t.type;return e||i||t||this.$message.error(this.$t("validate.limitUploadImgType")),e||i||t}},"on-success":{type:Function,default:null}},watch:{src:function(t,e){this.dialogVisible=""!=this.src,this.cropper&&this.cropper.replace(t)},srcPreview:function(t,e){-1==t.indexOf("music.126.net")&&-1==t.indexOf("mp.weixin.qq.com")&&-1==t.indexOf("mmbiz.qpic.cn")||this.fetchImgURL(t,"")}},data:function(){return{cropperImg:"",cropper:"",src:"",imgName:"",dialogVisible:!1}},computed:{srcPreview:function(){return this.value}},mounted:function(){},methods:{handleClose:function(t){this.src="",this.cropper.reset(),this.$refs.inputFile.value=this.src},initCropper:function(){this.cropper||(this.cropper=new s.a(this.$refs.img,{viewMode:1,dragMode:"move",aspectRatio:1,preview:".avatar"}))},eClickOpenImg:function(){this.$refs.inputFile.click()},checkBlob:function(t){var e=this;"function"==typeof this.beforeCrop&&this.beforeCrop(t)?(e.src=URL.createObjectURL(t),e.imgName=t.name||"unknow."+t.type.split("/")[1]):e.handleClose.call(e)},fetchImgURL:(n=Object(r.a)(regeneratorRuntime.mark(function t(e,i){var a,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=this,(n=new Image).setAttribute("crossOrigin","anonymous"),n.src=e,n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0,n.width,n.height),t.toBlob(function(t){return a.checkBlob(t)})};case 5:case"end":return t.stop()}},t,this)})),function(t,e){return n.apply(this,arguments)}),uploadImg:function(t){t=t.target.files[0];this.checkBlob(t)},uploadBlob:(a=Object(r.a)(regeneratorRuntime.mark(function t(e){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=this,(a=new FormData).append("nameMod",i.nameMod),a.append("subPath",i.subPath),a.append("upload_file",e,i.imgName),a=new Request(i.api,{method:"post",body:a}),fetch(a).then(function(t){return t.text()}).then(function(t){t=JSON.parse(t);200==t.status&&(i.src=t.data.path,i.src&&i.$emit("input",i.src),i.handleClose.call(i))}).catch(function(t){debugger});case 7:case"end":return t.stop()}},t,this)})),function(t){return a.apply(this,arguments)}),uploadCropImg:function(){this.cropper.getCroppedCanvas(this.cropSetting).toBlob(this.uploadBlob,"image/jpeg",1)},saveCropImg:function(){var i=this;this.cropper.getCroppedCanvas().toBlob(function(t){var e=window.URL.createObjectURL(t),t=document.createElement("a");t.href=e,t.download=i.imgName,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e)},"image/jpeg")}}}),i=(i("fc6c"),i("5d22")),r=Object(i.a)(r,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("el-form-item",{attrs:{label:"",prop:e.prop}},[t("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"always"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",plain:""},on:{click:e.eClickOpenImg}},[e._v("上传"),t("i",{staticClass:"el-icon-upload el-icon--right"})]),t("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputFile",attrs:{type:"file",multiple:"",accept:"image/png,image/gif,image/jpeg"},on:{change:e.uploadImg}})],1),t("el-tooltip",{attrs:{content:"只能上传jpg/png文件，上传前自动裁切",placement:"top",effect:"light"}},[e.srcPreview?t("img",{ref:"imgPreview",staticClass:"imgResult",attrs:{src:e.srcPreview}}):e._e()])],1),t("el-dialog",{attrs:{xs:20,title:"上传图片",width:"80%",visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.initCropper}},[t("div",{staticClass:"cropper",staticStyle:{width:"100%",height:"auto",border:"dashed #cacaca 1px","text-align":"center"}},[t("img",{ref:"img",staticStyle:{"max-width":"100%"},attrs:{src:e.src}})]),t("div",{staticClass:"cropperPreview",staticStyle:{display:"flex","align-items":"center","justify-content":"space-around"}},[t("div",[t("div",{staticClass:"avatar avatar-128",staticStyle:{overflow:"hidden",display:"inline-block"},attrs:{src:e.src}}),e._v("\n          像素尺寸128px*128px\n        ")]),t("div",[t("div",{staticClass:"avatar avatar-64",staticStyle:{overflow:"hidden",display:"inline-block"},attrs:{src:e.src}}),e._v("\n          像素尺寸64px*64px\n        ")]),t("div",[t("div",{staticClass:"avatar avatar-32",staticStyle:{overflow:"hidden",display:"inline-block"},attrs:{src:e.src}}),e._v("\n          像素尺寸32px*32px\n        ")])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.uploadCropImg}},[e._v("上 传")])],1)])],1)},[],!1,null,null,null);e.default=r.exports},8994:function(t,e,i){var a=i("388f");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("85cb").default)("ed5b9c8a",a,!0,{sourceMap:!1,shadowMode:!1})},fc6c:function(t,e,i){"use strict";i("8994")}}]);