(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-cb09e454"],{"6d92":function(t,e,i){"use strict";i.r(e);i("0bbd"),i("873e"),i("5c10");var s=i("0e2e"),l=(i("ac50"),i("b589"),i("250d")),a={props:{nameMod:{type:String,default:"rubyeyes"},label:{type:String,default:"标签"},listIds:{type:Array,default:[]},apiFind:{type:String,default:"/manage/contentTag/getList"},allowCreate:{type:Boolean,default:!0},apiAdd:{type:String,default:"/manage/contentTag/addOne"},initTag:{type:Function,default:function(t){return{name:t,comments:"即时创建",alias:t}}}},data:function(){return{userLoading:!1,listAllTags:[]}},watch:{listIds:function(e,i){var a=this,t=(e=e||[]).concat(i=i||[]).filter(function(t){return-1===i.indexOf(t)||-1===e.indexOf(t)}),n=0<t.length,s=n&&e.length>i.length,l=!0,t=(t=t.map(function(e){var t=a.listAllTags.find(function(t){return t._id==e});if(!t){if(!s)return!1;l=!1}return t})).filter(function(t){return t});n&&l&&(s&&this.$emit("add",{listObjDiff:t,listIds:e}),s||this.$emit("delete",{listObjDiff:t,listIds:e}),this.$emit("change",{listObjDiff:t,listIds:e,strAction:s?"add":"delete"}))}},computed:{},methods:{eChangeTags:function(){var n=this;this.listIds.forEach(function(e,t,i){if(e){var a=n.listAllTags.find(function(t){return t._id==e});if(!!a)e&&""!=e&&n.listIds.push(a._id),n.listIds=Object(s.a)(new Set(n.listIds));else{if(!(n.apiAdd&&n.allowCreate&&n.initTag))return!1;n.addTag(n.initTag(e))}}else n.$message.error("标签undefined：",e)})},addTag:function(i){var a=this,n=this;if(!n.apiAdd||!n.allowCreate||!n.initTag)return!1;n.loadingTag=!0,Object(l.a)({url:n.apiAdd,data:i,method:"post"}).then(function(t){var e;200===t.status&&t.data._id?(t.data&&n.listAllTags.unshift(t.data),-1!=(e=n.listIds.indexOf(i.name))?n.listIds[e]=t.data._id:n.listIds=n.clearListIdTags(),a.$emit("change",{listObjDiff:[t.data],listIds:n.listIds,strAction:"add"}),n.$message({message:n.$t("main.addSuccess"),type:"success"})):n.$message.error("添加标签错误："+t.message,i)}).catch(function(t){debugger;n.$message.error("添加标签错误："+t,i)}).finally(function(){n.loadingTag=!1})},findTags:function(t){var e=this,t=0<arguments.length&&void 0!==t&&t,i=this;this.userLoading=!0,Object(l.a)({url:i.apiFind,params:{pageSize:0,isPaging:"0",searchkey:t||null},method:"get"}).then(function(t){if(200==t.status){var e=t.data.docs||t.data||[];0<e.length&&(i.listAllTags=Object(s.a)(new Set(i.listAllTags.concat(e))))}else{debugger;i.$message.error("检索标签错误：status="+t.status,t)}}).catch(function(t){debugger}).finally(function(){e.userLoading=!1})},clearListIdTags:function(){var n=this;return this.listIds.filter(function(e,t,i){var a=!!n.listAllTags.find(function(t){return t._id==e});return a})}},mounted:function(){this.findTags()}},i=i("c701"),a=Object(i.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form-item",{attrs:{label:e.label,prop:"listIds"}},[i("el-select",{attrs:{size:"medium",multiple:"",filterable:"","allow-create":"","default-first-option":"",remote:"","remote-method":e.findTags,loading:e.userLoading,placeholder:e.$t("validate.selectNull",{label:this.label})},on:{change:e.eChangeTags},model:{value:e.listIds,callback:function(t){e.listIds=t},expression:"listIds"}},e._l(e.listAllTags,function(t){return i("el-option",{key:t._id,attrs:{label:t.name,value:t._id}})}),1)],1)},[],!1,null,null,null);e.default=a.exports},b589:function(t,e,i){"use strict";var a=i("c51c"),n=i("da31")(5),s="find",l=!0;s in[]&&Array(1)[s](function(){l=!1}),a(a.P+a.F*l,"Array",{find:function(t,e){return n(this,t,1<arguments.length?e:void 0)}}),i("d263")(s)}}]);