<!DOCTYPE html>
<html class="{{pageType}}">

<head>
    {% header adaptor="ie" %}

    <!-- 引入组件库 -->
    <!-- Production version -->
    {# <script src="https://unpkg.com/@popperjs/core@2"></script> #}
    {# <script src="https://cdn.bootcdn.net/ajax/libs/popper.js/2.6.0/umd/popper.min.js"></script> #}
    {% plugin name="popper twitter-bootstrap font-awesome betterScroll" %}
    {% endplugin %}
    {# 模块 #}
    {% from "./public/compNavAvatar.html" import navAvatar %}
    {% from "./public/compContainerList.html" import containerOfList %}
    <!-- 二次开发静态资源 -->
    {% assets 'dora.front.js white.css avatar.css artist.css' %}
    {% endassets %}

    {% endheader %}

    <input type="hidden" value="{{lsk}}" id="sysKeys">
</head>

<body>
    {# 整屏容器 #}
    {% include "./public/header.html" %}
    {# <div class="mainbody" id="{{pageType}}" style="width:100%;max-width:1199px;"> #}
    <div class="container-fluid position-absolute" id="{{pageType}}" style="width:100%;top:0px;">
        <input type="hidden" value="{{site.lang}}" id="siteLang">
        {# mainpage大红标题 scroll#}
        {% block cover %}
            <div class="overflow-visible position-relative" style="height:0px;z-index:100;">
                {# scroll #}
                <div class="row bs-wrapper-cover overflow-hidden" style="height:100vh;">
                    <div class="col bs-content px-0">
                        <div class="container-fluid bg-danger text-dark" style="min-height:100vh;">
                            <div class="row w-100" style="height:40vh;"></div>
                            <h1 class="display-1">RUBY</h1>
                            <h1 class="display-1">EYES</h1>
                            <h1 class="display-1">RECORDS</h1>
                            <h1 class="display-1">COMMIUNITY</h1>
                        </div>
                        {# 空容器 #}
                        <div class="container-fluid bg-transparent  position-relative" style="min-height:100vh;z-index:-100;"></div>
                    </div>
                </div>
            </div>
            <script>
                let slideCover = new BetterScroll.createBScroll('.bs-wrapper-cover', {
                    disableMouse: false,
                    disableTouch: false,
                    mouseWheel: {
                        speed: 20,
                        invert: false,
                        easeTime: 300
                    },
                    nestedScroll: {
                        groupId: 'cover-scroll'
                    },
                    slide: {
                        threshold: 100,
                        loop: false,
                        autoplay:false,
                        listenFlick:false,
                    },
                    useTransition: true,
                    momentum: false,
                    bounce: false,
                    stopPropagation: true
                })
                slideCover.on('slidePageChanged', (page) => {
                    $('.bs-wrapper-cover').hide();
                    // currentPageIndex = page.pageX
                })
            </script>    
        {% endblock %}
        {#         
        <div class="row bs-wrapper-main" style="top:12vh;height:89vh;overflow:hidden;white-space:nowrap;">
            <div class="col bs-content px-0 d-inline-block" style="max-width:none;">
                <div class="container-fluid d-inline-block bg-dark" style="height:88vh;overflow:hidden;"></div>
                <div class="container-fluid d-inline-block bg-danger" style="height:88vh;overflow:hidden;"></div>
                <div class="container-fluid d-inline-block bg-dark" style="height:88vh;overflow:hidden;"></div>
                <div class="container-fluid d-inline-block bg-danger" style="height:88vh;overflow:hidden;"></div>

            </div>
        </div>
        #}
        
        {# 内容区 #}
        <div class="row position-relative bs-wrapper-main" style="top:12vh;height:88vh;overflow:hidden;white-space:nowrap;">
            <div class="col bs-content px-0 d-inline-block" style="max-width:none;max-height:100%;">
                {# 单页模式 #}
                {% block content %}{% endblock %}
                {# 多页横播 #}
                {# {% set listPages = ['timeline','artists','records'] %} #}
                {# {% for page in navigation %} #}
                {# {% include navigation.pathListTemp %} #}
                {# {% else %} #}
                {# <div class="container-fluid  main-container position-relative" style="height:88vh;overflow:hidden;">loading</div> #}
                {# {% endfor %} #}
                {# {% block slideContent %}{% endblock %} #}
            </div>
            {% block navAvatar %}
            <div class="col-auto">
                {{navAvatar(listAvatars,128)}}
            </div>
            {% endblock %}
        </div>
        {# {% block navAvatar %}{% endblock %} #}
    </div>
    {% include "./public/footer.html" %}

    {# #}
    <script>
        {# BScroll.use(MouseWheel) #}
        {# BScroll.use(Slide) #}

        {# BScroll.use(NestedScroll) #}
        let slideMain = new BetterScroll.createBScroll('.bs-wrapper-main', {
            disableMouse: false,
            disableTouch: false,
            scrollX: true,
            scrollY: false,
            slide: {
                threshold: 100,
                loop: false,//TODO：可以优化为循环slide；注意：复制出来的slide需要querySelector and 设置translateY同步
                autoplay:false,
                listenFlick:false,
            },
            useTransition: true,
            momentum: false,
            bounce: false,
            stopPropagation: true,
            probeType: 2,
        })
        slideMain.on('slidePageChanged', (page) => {
            // currentPageIndex = page.pageX
        })
        slideMain.on('slideWillChange', (page) => {
            currentPageIndex = page.pageX
            console.log("slideMain.on(slideWillChange)",page);
        })
    </script>
     

</body>

</html>