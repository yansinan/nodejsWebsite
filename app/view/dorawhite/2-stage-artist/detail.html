{% from "../public/compListTags.html" import tag as domTag %}
{% from "../public/compListTags.html" import listTags as listTags %}

{# {% extends "../default.html" %}  #}


<link rel="stylesheet" href="/static/themes/dorawhite/css/detail.css">
<div class="detail artist font-normal" data-bs-main="{{post.docAlias}}">
    {# 乐队名 #}
    <div class="name">{{post.name}} {{post.alias if post.name!=post.alias else ""}}</div>
    {# 乐队图 #}
    <div class="album scrollerSnap">
        {% for image in post.listImages %}
        <img src="{{image.urlThumbsnail}}" height="100%" data-dr-url="{{image.url}}"/>{#  data-bs-toggle="modal" data-bs-target="#modalImagePreview"  #}
        {% endfor %}
    </div>
    {# 标签 #}
    {# 风格 #}
    {% if post.tags.length>0 and post.tags[0]%}
    <ul class="list-inline">
        {% for tag in post.tags %}
            {{ domTag(tag.name+"   "+tag.alias,'/search?q='+tag.name)  if tag else ""}}
        {% endfor %}
        {{ domTag(post.from,'/search?q='+post.from) if post.from!=""}}
    </ul>
    {% endif %}
    {# 介绍 #}
    <article class="">
        {{post.comments | safe}}
    </article>
    {# 友链 #}
    {% if post.listLinks.length>0%}
    <ol class="breadcrumb">
        {% for link in post.listLinks %}
        <li class="breadcrumb-item"><a href="{{link.url}}" target="_blank">{{link.name}}</a></li>
        {% endfor %}
    </ol>
    {% endif %}
    <div class="headEnd"></div>

    {# 专辑 #}
    {% if post.objDocsRecords.length>0%}
    <div class="block title records">
        <div class="list" style="--cnt-item:{{4 if post.objDocsRecords.length > 4 else post.objDocsRecords.length}}">      
            {% for item in post.objDocsRecords %}
                {# 乐队详情页 #}
                <a onclick="window.goto('{{item.url}}')" class="item {{'hide' if loop.index > 4}}">
                    <img src="{{item.sImg}} " class="img-fluid" alt="{{item.title}} " />
                    <div class="intro">
                        <p class="title">{{item.dateTimeline}}<br><span class="hoverUnderline">{{item.name}}</span></p>
                        {# 标签 #}
                        <div class="tags records">{{listTags(item.listFormatTags)}}</div>
                    </div>
                </a>
            {% endfor %} 
        </div>
    </div>
    {% if post.listVideos.length >3 %}<div class="more hoverUnderline" data-dr-target="records">更多</div>{% endif %}
    {% endif %}
    {# 视频 #}
    {% if post.listVideos.length>0%}
    <div class="block title videos">
        <div class="list" style="--cnt-item:{{3 if post.listVideos.length > 3 else post.listVideos.length}}">      
            {% for item in post.listVideos %}
                {# 乐队详情页 #}
                <a href="{{item.link}} " target="_blank " class="item videoWrapper hoverUnderline">
                    <img src="{{item.urlImg}} " class="img-fluid" alt="{{item.title}} " />
                    <span class="title">{{item.name}}</span>
                </a>
            {% endfor %} 
        </div>
    </div>
    {% if post.listVideos.length >3 %}<div class="more hoverUnderline" data-dr-target="videos">更多</div>{% endif %}
    {% endif %}
    {# 时间轴 #}
    {% if post.listTimeline.length>0%}
    <div class="block title news">
        <div class="list" style="--cnt-item:{{4 if post.listTimeline.length > 4 else post.listTimeline.length}}">      
            {% for item in post.listTimeline %}
            {# {%if post.listTimeline[loop.first]  or itme.dateYear!=post.listTimeline[loop.revindex0].dateYear %} #}
            {# <div class="year">{{ item.dateYear}}</div> #}
            {# {% endif %} #}
            <a class="item hoverUnderline" onclick="window.goto('{{item.url}}')">
                {# <span class="date" >{{ item.dateTimeline}}</span> #}
                {{ item.name }}
            </a>                            
            {% endfor %}
        </div>
    </div>
    {% if post.listTimeline.length >4 %}<div class="more hoverUnderline" data-dr-target="news">更多</div>{% endif %}
    {% endif %}    

    {# 周边 #}
    {% if post.listDocsGoods.length>0%}
    <div class="block title goods">
        <div class="list" style="--cnt-item:{{6 if post.listDocsGoods.length > 6 else post.listDocsGoods.length}}">      
            {% for item in post.listDocsGoods %}
                {# 乐队详情页 #}
                <a onclick="window.goto('{{item.url}}')" class="item {{'hide' if loop.index > 5}}">
                    <img src="{{item.sImg}} " class="img-fluid" alt="{{item.title}} " />
                    <div class="intro">
                        <p class="title"><span class="hoverUnderline">{{item.name}}</span></p>
                        {# 标签 #}
                        {# <div class="tags goods">{{listTags(item.listFormatTags)}}</div> #}
                    </div>
                </a>
            {% endfor %} 
        </div>
    </div>
    {% if post.listDocsGoods.length >6 %}<div class="more hoverUnderline" data-dr-target="goods">更多</div>{% endif %}
    {% endif %}    

</div>
{# 浮动导航 #}
<div class="nav artist">
    <ul>
        <div class="backTop" ms-on-click="@eBnDetailNav(e,'.name')"></div>
        {% for link in post.listNav %}
        <li class="hoverUnderline" ms-on-click="@eBnDetailNav(e,'{{link.tar}}')">{{link.name}}</li>
        {% endfor %}
        <li class="player" ms-on-click="@eAudioToggleNow(e)"><i class="fa" :class="@playerStatus"/></li>
    </ul>
    {# 精选单曲 #}
    {% if post.listHotMusics.length>0%}
    <div class="playList" :class="@playerStatus">
        <ul>
            {% for link in post.listHotMusics %}
            <li class="song">
                <span ms-on-click="@eAudioToggle($event,'{{loop.index}}')" data-link="{{link.url}}" data-current-time="0 : 0 / 0 : 0">
                    {{link.name}}
                    <audio src="{{link.url}}" preload="metadata">Your browser does not support the <code>audio</code> element.</audio>
                </span>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>
